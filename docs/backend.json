
{
  "entities": {
    "FormTemplate": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "FormTemplate",
      "type": "object",
      "description": "Represents a PDF template used as a base form.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the FormTemplate entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the form template."
        },
        "pdfUrl": {
          "type": "string",
          "description": "URL where the PDF template is stored.",
          "format": "uri"
        },
        "userId": {
          "type": "string",
          "description": "Reference to User who uploaded this template. (Relationship: User 1:N FormTemplate)"
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the form template was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "name",
        "pdfUrl",
        "userId",
        "createdAt"
      ]
    },
    "InputField": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "InputField",
      "type": "object",
      "description": "Represents an input field placed on a form template.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the InputField entity."
        },
        "formTemplateId": {
          "type": "string",
          "description": "Reference to FormTemplate this input field belongs to. (Relationship: FormTemplate 1:N InputField)"
        },
        "xPosition": {
          "type": "number",
          "description": "X-coordinate of the input field on the template."
        },
        "yPosition": {
          "type": "number",
          "description": "Y-coordinate of the input field on the template."
        },
        "width": {
          "type": "number",
          "description": "Width of the input field."
        },
        "height": {
          "type": "number",
          "description": "Height of the input field."
        },
        "type": {
          "type": "string",
          "description": "Type of input field (e.g., text, number, date)."
        },
        "isRequired": {
          "type": "boolean",
          "description": "Indicates if the input field is required."
        }
      },
      "required": [
        "id",
        "formTemplateId",
        "xPosition",
        "yPosition",
        "width",
        "height",
        "type",
        "isRequired"
      ]
    },
    "FormData": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "FormData",
      "type": "object",
      "description": "Represents the data entered into a form based on a template.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the FormData entity."
        },
        "formTemplateId": {
          "type": "string",
          "description": "Reference to the FormTemplate used to generate this data. (Relationship: FormTemplate 1:N FormData)"
        },
        "inputFieldId": {
          "type": "string",
          "description": "Reference to the InputField that this data is associated with. (Relationship: InputField 1:N FormData)"
        },
        "value": {
          "type": "string",
          "description": "The data entered into the input field."
        }
      },
      "required": [
        "id",
        "formTemplateId",
        "inputFieldId",
        "value"
      ]
    },
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        },
        "name": {
          "type": "string",
          "description": "Name of the user."
        }
      },
      "required": [
        "id",
        "email",
        "name"
      ]
    },
    "Layout": {
      "title": "Layout",
      "type": "object",
      "description": "Stores the visual layout and coordinates for form fields.",
      "properties": {
        "userId": {
          "type": "string",
          "description": "The UID of the user who owns this layout."
        },
        "fields": {
          "type": "array",
          "items": {
            "$ref": "#/entities/InputField"
          }
        }
      },
      "required": ["userId", "fields"]
    },
    "Report": {
      "title": "Report",
      "type": "object",
      "description": "Represents a single, complete vehicle valuation report.",
      "properties": {
        "id": {
          "type": "string",
          "description": "The unique ID of the report document."
        },
        "vehicleId": {
          "type": "string",
          "description": "The vehicle registration number, used for searching."
        },
        "userId": {
          "type": "string",
          "description": "The UID of the user who created the report."
        },
        "reportData": {
          "type": "object",
          "description": "A key-value map of all data entered for the report."
        },
        "createdAt": {
          "type": "number",
          "description": "Timestamp when the report was created."
        },
        "updatedAt": {
          "type": "number",
          "description": "Timestamp when the report was last updated."
        }
      },
      "required": ["id", "vehicleId", "userId", "reportData", "createdAt", "updatedAt"]
    },
    "ReportHistory": {
      "title": "ReportHistory",
      "type": "object",
      "description": "A snapshot of a report at a specific point in time, for auditing purposes.",
      "properties": {
        "id": {
          "type": "string",
          "description": "The unique ID of the history entry."
        },
        "reportId": {
          "type": "string",
          "description": "The ID of the parent report."
        },
        "vehicleId": {
          "type": "string",
          "description": "The vehicle registration number at the time of saving."
        },
        "userId": {
          "type": "string",
          "description": "The UID of the user who saved this version."
        },
        "userName": {
          "type": "string",
          "description": "The name of the user who saved this version."
        },
        "reportData": {
          "type": "object",
          "description": "A key-value map of all data entered for the report at this point in time."
        },
        "savedAt": {
          "type": "number",
          "description": "Timestamp when this version was saved."
        }
      },
      "required": ["id", "reportId", "vehicleId", "userId", "userName", "reportData", "savedAt"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous",
      "google.com"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Collection of user documents. The userId is the Firebase Authentication UID.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase Authentication UID of the user."
            }
          ]
        }
      },
      {
        "path": "/layouts/{userId}",
        "definition": {
            "entityName": "Layout",
            "schema": { "$ref": "#/entities/Layout" },
            "description": "Stores the user-specific layout of form fields.",
            "params": [{
                "name": "userId",
                "description": "The UID of the user who owns this layout."
            }]
        }
      },
      {
        "path": "/reports/{reportId}",
        "definition": {
          "entityName": "Report",
          "schema": { "$ref": "#/entities/Report" },
          "description": "Stores complete, individual valuation reports. Denormalized for easy searching.",
          "params": [{
            "name": "reportId",
            "description": "The unique ID of the report."
          }]
        }
      },
      {
        "path": "/reports/{reportId}/history/{historyId}",
        "definition": {
          "entityName": "ReportHistory",
          "schema": { "$ref": "#/entities/ReportHistory" },
          "description": "Stores snapshots of a report over time for auditing.",
          "params": [
            {
              "name": "reportId",
              "description": "The ID of the parent report."
            },
            {
              "name": "historyId",
              "description": "The unique ID of the history entry."
            }
          ]
        }
      }
    ]
  }
}

    